<%= link_to( t('.back_to_dashboard'), root_path, class: 'btn btn-primary' ) %>
<h1><%= t('.member_directory') %></h1>

<div>
  <!-- Search Form -->
  <%= form_with url: users_path, method: :get, local: true do %>
    <div class="form-group">
      <%= label_tag :search, t('users.index.search_members', default: "Search Members") %>
      <%= text_field_tag :search, params[:search], placeholder: t('users.index.search_bar', default: "Enter full name or email"), class: "form-control" %>
      
      <%= label_tag :major,  t('users.index.filter_by_major', default: "Filter by Major") %>
      <%= select_tag :major, options_for_select(@majors.map { |m| [m.name, m.id] }, params[:major]), include_blank: 'All Majors', class: "form-control", onchange: 'this.form.submit();' %>

      <%= label_tag :class_year, t('users.index.filter_by_class_year', default: "Filter by Class Year") %>
      <%= select_tag :class_year, options_for_select(@class_years.map { |cy| [cy.name, cy.id] }, params[:class_year]), include_blank: 'All Class Years', class: "form-control", onchange: 'this.form.submit();' %>

      <%= label_tag :per_page, t('users.index.items_per_page', default: "Items per page") %>
      <%= select_tag :per_page, options_for_select([5, 10, 20], params[:per_page] || 10), onchange: 'this.form.submit();', class: "form-control" %>
      
      <%= submit_tag "Search", class: "btn btn-primary" %>
    </div>
  <% end %>

  <!-- Users Table -->
  <table class="table table-striped">
    <thead>
      <tr>
        <th><%= t('.name') %></th>
        <th><%= t('.email') %></th>
        <th><%= t('.bio') %></th>
        <th><%= t('.class_year') %></th>
        <th><%= t('.major') %></th>
        <th><%= t('.role') %></th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td><%= user.full_name %></td>
          <td><%= user.email %></td>
          <td><%= user.bio %></td>
          <td><%= user.class_year.present? ? user.class_year.name : '' %></td>
          <td><%= user.major.present? ? user.major.name : '' %></td>
          <td><%= user.role.name %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <!-- Pagination -->
  <%= paginate @users %>
</div>
